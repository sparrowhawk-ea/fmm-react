!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("react"),require("@eafmm/core")):"function"==typeof define&&define.amd?define(["exports","tslib","react","@eafmm/core"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).sayHello={},e.tslib,e.React,e.core)}(this,(function(e,t,r,n){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=a(r);const l=o.default.forwardRef(((e,r)=>{var{aggregateLabels:n,anchorRef:a,children:l,customElementIds:u,debounceMsec:c,dynamicLabels:i,framework:d,onUpdate:f,pageRef:p,panelRef:v,parentRef:R,storeRef:g,title:b,usePanelDetail:h,useWidthToScale:F,verbosity:S,zoomFactor:y}=e,w=t.__rest(e,["aggregateLabels","anchorRef","children","customElementIds","debounceMsec","dynamicLabels","framework","onUpdate","pageRef","panelRef","parentRef","storeRef","title","usePanelDetail","useWidthToScale","verbosity","zoomFactor"]);if(l)throw new Error("FmmReactMinimapTag is a contentless tag");const E=o.default.useRef(null);return m(r,s("",E,{aggregateLabels:n,anchorRef:a,customElementIds:u,debounceMsec:c,dynamicLabels:i,framework:d,onUpdate:f,pageRef:p,panelRef:v,parentRef:R,storeRef:g,title:b,usePanelDetail:h,useWidthToScale:F,verbosity:S,zoomFactor:y})),o.default.createElement("div",Object.assign(Object.assign({},w),{ref:e=>{let t=null==e?void 0:e.parentElement;for(;t&&"FORM"!==t.tagName;)t=t.parentElement;if(e&&!t)throw new Error("FmmReactMinimapTag must be used inside a FORM tag");E.current=t}}))})),u=o.default.forwardRef((({children:e,detailParentRef:t,vertical:r=!1},a)=>{if(e)throw new Error("FmmReactPanelTag is a contentless tag");const l=o.default.useRef(null);return m(a,i(l,t,r)),o.default.createElement("div",{className:"fmm-panel",ref:l},o.default.createElement("style",null,n.Fmm.CSS))})),c=o.default.forwardRef((({children:e,errors:t,values:r},n)=>{if(e)throw new Error("FmmReactStoreTag is a contentless tag");return m(n,d(r,t)),null})),s=(e,t,r)=>{const a=o.default.useRef(),l=o.default.useRef(null),u=()=>{var e,o,u,c,s;const i={aggregateLabels:r.aggregateLabels,anchor:null===(e=r.anchorRef)||void 0===e?void 0:e.current,debounceMsec:r.debounceMsec,dynamicLabels:r.dynamicLabels,form:new n.FmmFormHTML(t.current,null===(o=r.pageRef)||void 0===o?void 0:o.current),framework:r.framework,onUpdate:r.onUpdate,store:null===(u=r.storeRef)||void 0===u?void 0:u.current,title:r.title,usePanelDetail:r.usePanelDetail,useWidthToScale:r.useWidthToScale,verbosity:r.verbosity,zoomFactor:r.zoomFactor},d=(null===(c=r.panelRef)||void 0===c?void 0:c.current)?p.PANELS.get(r.panelRef.current):void 0;return a.current=d?d.createMinimap(i):n.Fmm.createMinimap(i,null===(s=r.parentRef)||void 0===s?void 0:s.current),a.current?(l.current={destructor:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.destructor()},takeSnapshot:()=>{var e;return!!(null===(e=a.current)||void 0===e?void 0:e.takeSnapshot())}},()=>{a.current&&a.current.detach(),a.current=void 0}):()=>{}};return f(u),o.default.useEffect((()=>(a.current&&a.current.destructor(),l.current=null,a.current=void 0,u())),[e]),o.default.useEffect((()=>{a.current&&a.current.compose(r.customElementIds)}),[r.customElementIds,e,a]),a.current&&a.current.takeSnapshot(),l},i=(e,t,r)=>{const a=o.default.useRef(null);return f((()=>{const o=n.Fmm.createPanel(e.current,null==t?void 0:t.current,r,void 0);return a.current={destroyDetached:()=>o.destroyDetached()},p.PANELS.set(a.current,o),()=>{o.destructor(),p.PANELS.delete(a.current)}})),a},d=(e,t)=>{const r=o.default.useRef(new n.FmmStoreImpl(e,t));return r.current.update(e,t),r},f=e=>o.default.useEffect(e,[]),m=(e,t)=>o.default.useEffect((()=>{"function"==typeof e?e(t.current):e&&(e.current=t.current)}),[e,t]),p={PANELS:new WeakMap},v={createFrameworkItem(e,t){if("INPUT"===t.tagName){const e=t.type;if("checkbox"===e||"radio"===e)return g.Check}return t.classList.contains("MuiSelect-nativeInput")?g.Select:g.Other}};class R extends n.FmmFrameworkItemHTML{constructor(e){super(e||"MuiFormControl-root")}getError(e,t,r,n){var a;return(null===(a=null==r?void 0:r.querySelector(".MuiFormHelperText-root"))||void 0===a?void 0:a.textContent)||""}}const g={Check:new class extends R{constructor(){super("MuiFormControlLabel-root")}getLabel(e,t){return null==t?void 0:t.querySelector("SPAN.MuiFormControlLabel-label")}},Select:new class extends R{getValue(e,t,r,n){var a,o;return(null===(o=null===(a=t.parentElement)||void 0===a?void 0:a.querySelector("#mui-component-select-"+e))||void 0===o?void 0:o.textContent)||""}},Other:new R};e.FmmMaterialUI=v,e.FmmReactMinimapTag=l,e.FmmReactPanelTag=u,e.FmmReactStoreTag=c,e.useFmmReactMinimap=s,e.useFmmReactPanel=i,e.useFmmReactStore=d,e.useOnceAfterFirstRender=f,e.useSetRef=m,Object.defineProperty(e,"__esModule",{value:!0})}));